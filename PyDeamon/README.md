# 中间层后台服务

目前(23 Dec. 2019)的设计是`前端-中间层-后端`的模式, 通过数据库传递数据.  
前端是基于酷Q的, 基础的用户接口; 中间层用于触发前端以及事件基础预处理并决定如何移交给后端; 后端可以是可扩展的应用或者应用组.  
酷Q自己的日志系统会记录所有的QQ消息及事件, 后端程序(组)可以按自身的情况分析酷Q日志也可以被中间层触发去处理中间层的请求, 中间层可以做一些基础的应答/日志/统计并根据预处理结果和预设规则选择后端应用. 中间层还负责检查检查和翻译后端的处理结果.  

中间层和前端之间通过3个win32event触发: "CQdbSync", "CQupdate", "CQexit", 分别用于中间层触发前端/前端触发中间层/全局退出.  

## 开发笔记  

31 Dec. 2019 考虑到前后端通信时序问题以及在python中open不存在的win32event会出错而C++中打开只是得到NULL, 所以把所有的事件在后端创建前端打开, 先运行后端在打开前端.  